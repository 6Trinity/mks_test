(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}})();let a,B,L,b,y,r,h,m,v,E;const O="1FAIpQLSfv-nxvgjLHYWsg5nGpOkqsZk3voWtGDy30Rof2gHP65peyWA",k=`https://docs.google.com/forms/d/e/${O}/formResponse`,g={name:"entry.38755223",phone:"entry.1626865542",email:"entry.910260297",message:"entry.1197614220",testData:"entry.574560963"};async function _(t){try{const e=new URLSearchParams;if(e.append(g.name,t.name||"Не указано"),e.append(g.phone,t.phone||"Не указано"),e.append(g.email,t.email||"Не указано"),e.append(g.message,t.message||"Не указано"),m.length>0){const s=m.map(i=>`${i.name} - ${i.price.toLocaleString()} руб.`).join("; ");e.append(g.testData,`Опции: ${s}; Итого: ${h.toLocaleString()} руб.`)}return await fetch(k,{method:"POST",body:e,mode:"no-cors"}),!0}catch{return console.log("Данные сохранены локально"),saveToLocalStorage(t),!0}}const p=t=>{document.body.style.overflow=t?"":"hidden"};function A(){S(),P()}function P(){document.querySelectorAll(".calculator-test__button").forEach(e=>{e.addEventListener("click",function(){const s=parseInt(this.getAttribute("data-price")),i=this.getAttribute("data-name");m.push({step:r,name:i,price:s}),h+=s,x()})}),B.addEventListener("click",D),L.addEventListener("click",x);const t=document.querySelector(".calculator-form__feed");t&&t.addEventListener("submit",async function(e){e.preventDefault();const s={name:this.querySelector('[name="name"]').value,phone:this.querySelector('[name="phone"]').value,email:this.querySelector('[name="email"]').value,message:"Заявка из калькулятора"};await _(s),this.reset()})}function C(){E&&E.addEventListener("submit",async function(t){t.preventDefault();const e={name:this.querySelector('[name="name"]').value,phone:this.querySelector('[name="phone"]').value,email:this.querySelector('[name="email"]').value,message:this.querySelector('[name="message"]').value||""};await _(e),this.reset()}),v&&v.addEventListener("submit",async function(t){t.preventDefault();const e={name:this.querySelector('[name="name"]').value,phone:this.querySelector('[name="phone"]').value,email:this.querySelector('[name="email"]').value,message:this.querySelector('[name="message"]').value||""};await _(e),this.reset()})}function x(){if(r<a.length){if(a[r-1].classList.remove("active"),a[r-1].classList.add("hiding"),r++,setTimeout(()=>{a[r-1].classList.remove("hiding"),a[r-1].classList.add("active")},350),S(),r===a.length){document.getElementById("total-price").textContent=h.toLocaleString(),y.classList.add("active"),L.textContent="Завершить";const t=m.map(s=>`<div class="flex gap-05">
                    <span>${s.name} ~ </span>
                    <span>${s.price.toLocaleString()} руб.</span>
                </div>`).join(""),e=document.getElementById("result-price");e.innerHTML=`${t}`}}else F(),a[r-1].classList.remove("hiding"),a[r-1].classList.add("active")}function D(){r>1&&(w(r),a[r-1].classList.remove("active"),a[r-1].classList.add("hiding"),r--,setTimeout(()=>{a[r-1].classList.remove("hiding"),a[r-1].classList.add("active")},350),S(),w(r),L.textContent="Следующий")}function w(t){m=m.filter(e=>e.step!==t),h=m.reduce((e,s)=>e+s.price,0)}function S(){b&&(b.textContent=`${r} / ${a.length}`)}function F(){r=1,h=0,m=[],a.forEach(e=>e.classList.remove("active")),a[0].classList.add("active"),L.textContent="Следующий",S(),document.getElementById("total-price").textContent="0";const t=document.getElementById("result-price");t&&(t.innerHTML="")}function G(t){let e=t.replace(/\D/g,"");e.length===11&&e[0]==="8"&&(e="7"+e.slice(1));let s="+7";if(e.length>1){const i=e.substring(1);i.length>0&&(s+=" ("+i.substring(0,3)),i.length>3&&(s+=") "+i.substring(3,6)),i.length>6&&(s+="-"+i.substring(6,8)),i.length>8&&(s+="-"+i.substring(8,10))}return s}class R{constructor(){this.observer=null,this.init()}init(){this.observer=new IntersectionObserver(e=>{e.forEach(s=>{s.isIntersecting&&(s.target.classList.add("visible"),this.observer.unobserve(s.target))})},{threshold:.05,rootMargin:"0px 0px -50px 0px"}),document.querySelectorAll(".fade-in").forEach(e=>{this.observer.observe(e)})}}class T{constructor(e){this.gallery=e,this.items=this.gallery.querySelectorAll(".reviews-galery__item"),this.prevBtn=this.gallery.querySelector(".reviews-galery__prev"),this.nextBtn=this.gallery.querySelector(".reviews-galery__next"),this.currentIndex=0,this.init()}init(){this.prevBtn.addEventListener("click",()=>{this.showPrevious()}),this.nextBtn.addEventListener("click",()=>{this.showNext()}),this.updateGallery()}showPrevious(){this.currentIndex--,this.currentIndex<0&&(this.currentIndex=this.items.length-1),this.updateGallery()}showNext(){this.currentIndex++,this.currentIndex>=this.items.length&&(this.currentIndex=0),this.updateGallery()}updateGallery(){this.items.forEach(e=>{e.classList.remove("active")}),this.items[this.currentIndex].classList.add("active")}}document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".appheader-baner__button"),s=document.querySelector(".appheader-baner"),i=document.querySelector(".appheader-baner__nav"),o=document.querySelectorAll(".reviews-baner__galery"),l=document.querySelectorAll(".popup-button"),u=document.querySelector(".popup-baner"),I=document.querySelectorAll(".popup-button__close");r=1,h=0,m=[],y=document.querySelector(".calculator-form__button"),a=document.querySelectorAll(".calculator-test__step"),B=document.getElementById("calculator-test__prev"),L=document.getElementById("calculator-test__next"),b=document.getElementById("nav-steps"),v=document.getElementById("popup-baner__form"),E=document.getElementById("feedbackForm"),new R,window.addEventListener("scroll",()=>{window.scrollY>50?s.classList.add("scrolled"):s.classList.remove("scrolled")}),e.addEventListener("click",()=>{e.classList.toggle("active"),i.classList.toggle("active"),p(!i.classList.contains("active"))}),y&&y.addEventListener("click",()=>{y.classList.toggle("active")}),document.querySelectorAll("body a").forEach(n=>{n.addEventListener("click",c=>{i.classList.remove("active"),e.classList.remove("active"),p(!0);const d=n.getAttribute("href");if(d.startsWith("#")){c.preventDefault();const f=document.querySelector(d);f&&f.scrollIntoView({behavior:"smooth"})}})}),document.querySelectorAll(".userPhone").forEach(n=>{n.value||(n.value="+7"),n.addEventListener("click",function(c){c.target.value==="+7"&&c.target.setSelectionRange(2,2)}),n.addEventListener("focus",function(c){c.target.value==="+7"&&setTimeout(()=>c.target.setSelectionRange(2,2),0)}),n.addEventListener("input",function(c){const d=c.target.selectionStart;let f=c.target.value.replace(/\D/g,""),q=G(f);c.target.value=q,d===2&&q.length>2&&c.target.setSelectionRange(2,2)}),n.addEventListener("keydown",function(c){if(c.key==="Backspace"&&/[^\d]/.test(n.value[n.selectionStart-1])){c.preventDefault();const d=n.selectionStart-1;n.setSelectionRange(d,d)}})}),o.forEach(n=>{new T(n)}),l.forEach(n=>{n.addEventListener("click",function(){v.classList.add("active"),u.classList.add("active"),p(!1)})}),I.forEach(n=>{n.addEventListener("click",function(){v.classList.remove("active"),u.classList.remove("active"),p(!0)})}),document.addEventListener("click",function(n){if(!u||!u.classList.contains("active"))return;const c=v.contains(n.target),d=n.target.closest(".popup-button"),f=n.target.closest(".popup-form__button");!c&&!d&&!f&&(u.classList.remove("active"),v.classList.remove("active"),p(!0))}),document.addEventListener("keydown",function(n){n.key==="Escape"&&u&&u.classList.contains("active")&&(u.classList.remove("active"),v.classList.remove("active"),p(!0))}),A(),C()});
