(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const g of l.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&r(g)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();let a,B,b,E,L,i,f,d,h,_;const A="1FAIpQLSfv-nxvgjLHYWsg5nGpOkqsZk3voWtGDy30Rof2gHP65peyWA",k=`https://docs.google.com/forms/d/e/${A}/formResponse`,y={name:"entry.38755223",phone:"entry.1626865542",email:"entry.910260297",message:"entry.1197614220",testData:"entry.574560963"};async function x(s){try{const e=new URLSearchParams;if(e.append(y.name,s.name||"Не указано"),e.append(y.phone,s.phone||"Не указано"),e.append(y.email,s.email||"Не указано"),e.append(y.message,s.message||"Не указано"),d.length>0){const t=d.map(r=>`${r.name} - ${r.price.toLocaleString()} руб.`).join("; ");e.append(y.testData,`Опции: ${t}; Итого: ${f.toLocaleString()} руб.`)}return await fetch(k,{method:"POST",body:e,mode:"no-cors"}),!0}catch{return console.log("Данные сохранены локально"),saveToLocalStorage(s),!0}}const p=s=>{document.body.style.overflow=s?"":"hidden"};function O(){S(),C()}function C(){document.querySelectorAll(".calculator-test__button").forEach(e=>{e.addEventListener("click",function(){const t=parseInt(this.getAttribute("data-price")),r=this.getAttribute("data-name");d.push({step:i,name:r,price:t}),f+=t,w()})}),B.addEventListener("click",G),b.addEventListener("click",w);const s=document.querySelector(".calculator-form__feed");s&&s.addEventListener("submit",async function(e){e.preventDefault();const t={name:this.querySelector('[name="name"]').value,phone:this.querySelector('[name="phone"]').value,email:this.querySelector('[name="email"]').value,message:"Заявка из калькулятора"};await x(t),this.reset()})}function D(){_&&_.addEventListener("submit",async function(s){s.preventDefault();const e={name:this.querySelector('[name="name"]').value,phone:this.querySelector('[name="phone"]').value,email:this.querySelector('[name="email"]').value,message:this.querySelector('[name="message"]').value||""};await x(e),this.reset()}),h&&h.addEventListener("submit",async function(s){s.preventDefault();const e=document.getElementById("model_name"),t=e?e.value:"Не указана",r={name:this.querySelector('[name="name"]').value,phone:this.querySelector('[name="phone"]').value,email:this.querySelector('[name="email"]').value,message:this.querySelector('[name="message"]').value||""};t!=="Не указана"&&(r.message=`Модель: ${t}. ${r.message}`),await x(r),this.reset()})}function w(){if(i<a.length){if(a[i-1].classList.remove("active"),a[i-1].classList.add("hiding"),i++,setTimeout(()=>{a[i-1].classList.remove("hiding"),a[i-1].classList.add("active")},350),S(),i===a.length){document.getElementById("total-price").textContent=f.toLocaleString(),L.classList.add("active"),b.textContent="Завершить";const s=d.map(t=>`<div class="flex gap-05">
                    <span>${t.name} ~ </span>
                    <span>${t.price.toLocaleString()} руб.</span>
                </div>`).join(""),e=document.getElementById("result-price");e.innerHTML=`${s}`}}else F(),a[i-1].classList.remove("hiding"),a[i-1].classList.add("active")}function G(){i>1&&(I(i),a[i-1].classList.remove("active"),a[i-1].classList.add("hiding"),i--,setTimeout(()=>{a[i-1].classList.remove("hiding"),a[i-1].classList.add("active")},350),S(),I(i),b.textContent="Следующий")}function I(s){d=d.filter(e=>e.step!==s),f=d.reduce((e,t)=>e+t.price,0)}function S(){E&&(E.textContent=`${i} / ${a.length}`)}function F(){i=1,f=0,d=[],a.forEach(e=>e.classList.remove("active")),a[0].classList.add("active"),b.textContent="Следующий",S(),document.getElementById("total-price").textContent="0";const s=document.getElementById("result-price");s&&(s.innerHTML="")}function R(s){let e=s.replace(/\D/g,"");e.length===11&&e[0]==="8"&&(e="7"+e.slice(1));let t="+7";if(e.length>1){const r=e.substring(1);r.length>0&&(t+=" ("+r.substring(0,3)),r.length>3&&(t+=") "+r.substring(3,6)),r.length>6&&(t+="-"+r.substring(6,8)),r.length>8&&(t+="-"+r.substring(8,10))}return t}class ${constructor(){this.observer=null,this.init()}init(){this.observer=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&(t.target.classList.add("visible"),this.observer.unobserve(t.target))})},{threshold:.05,rootMargin:"0px 0px -50px 0px"}),document.querySelectorAll(".fade-in").forEach(e=>{this.observer.observe(e)})}}class T{constructor(e){this.mainPhoto=e.querySelector("#main-photo"),this.thumbs=e.querySelectorAll(".thumb"),this.prevBtn=e.querySelector(".banya-button_prev"),this.nextBtn=e.querySelector(".banya-button_next"),this.currentIndex=0,this.init()}init(){this.thumbs.forEach((e,t)=>{e.addEventListener("click",()=>{this.setActivePhoto(t)})}),this.prevBtn.addEventListener("click",()=>this.prevPhoto()),this.nextBtn.addEventListener("click",()=>this.nextPhoto())}setActivePhoto(e){this.currentIndex=e,this.mainPhoto.src=this.thumbs[e].src,this.thumbs.forEach(t=>t.classList.remove("active")),this.thumbs[e].classList.add("active")}nextPhoto(){let e=(this.currentIndex+1)%this.thumbs.length;this.setActivePhoto(e)}prevPhoto(){let e=(this.currentIndex-1+this.thumbs.length)%this.thumbs.length;this.setActivePhoto(e)}}class M{constructor(e){this.gallery=e,this.items=this.gallery.querySelectorAll(".reviews-galery__item"),this.prevBtn=this.gallery.querySelector(".reviews-galery__prev"),this.nextBtn=this.gallery.querySelector(".reviews-galery__next"),this.currentIndex=0,this.init()}init(){this.prevBtn.addEventListener("click",()=>{this.showPrevious()}),this.nextBtn.addEventListener("click",()=>{this.showNext()}),this.updateGallery()}showPrevious(){this.currentIndex--,this.currentIndex<0&&(this.currentIndex=this.items.length-1),this.updateGallery()}showNext(){this.currentIndex++,this.currentIndex>=this.items.length&&(this.currentIndex=0),this.updateGallery()}updateGallery(){this.items.forEach(e=>{e.classList.remove("active")}),this.items[this.currentIndex].classList.add("active")}}document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".appheader-baner__button"),t=document.querySelector(".appheader-baner"),r=document.querySelector(".appheader-baner__nav"),o=document.querySelectorAll(".reviews-baner__galery"),l=document.querySelectorAll(".banya-baner__galery"),g=document.querySelectorAll(".popup-button"),m=document.querySelector(".popup-baner"),P=document.querySelectorAll(".popup-button__close");i=1,f=0,d=[],L=document.querySelector(".calculator-form__button"),a=document.querySelectorAll(".calculator-test__step"),B=document.getElementById("calculator-test__prev"),b=document.getElementById("calculator-test__next"),E=document.getElementById("nav-steps"),h=document.getElementById("popup-baner__form"),_=document.getElementById("feedbackForm"),new $,l.forEach(n=>new T(n)),window.addEventListener("scroll",()=>{window.scrollY>50?t.classList.add("scrolled"):t.classList.remove("scrolled")}),e.addEventListener("click",()=>{e.classList.toggle("active"),r.classList.toggle("active"),p(!r.classList.contains("active"))}),L&&L.addEventListener("click",()=>{L.classList.toggle("active")}),document.querySelectorAll("body a").forEach(n=>{n.addEventListener("click",c=>{r.classList.remove("active"),e.classList.remove("active"),p(!0);const u=n.getAttribute("href");if(u.startsWith("#")){c.preventDefault();const v=document.querySelector(u);v&&v.scrollIntoView({behavior:"smooth"})}})}),document.querySelectorAll(".userPhone").forEach(n=>{n.value||(n.value="+7"),n.addEventListener("click",function(c){c.target.value==="+7"&&c.target.setSelectionRange(2,2)}),n.addEventListener("focus",function(c){c.target.value==="+7"&&setTimeout(()=>c.target.setSelectionRange(2,2),0)}),n.addEventListener("input",function(c){const u=c.target.selectionStart;let v=c.target.value.replace(/\D/g,""),q=R(v);c.target.value=q,u===2&&q.length>2&&c.target.setSelectionRange(2,2)}),n.addEventListener("keydown",function(c){if(c.key==="Backspace"&&/[^\d]/.test(n.value[n.selectionStart-1])){c.preventDefault();const u=n.selectionStart-1;n.setSelectionRange(u,u)}})}),o.forEach(n=>{new M(n)}),g.forEach(n=>{n.addEventListener("click",function(){h.classList.add("active"),m.classList.add("active"),p(!1)})}),P.forEach(n=>{n.addEventListener("click",function(){h.classList.remove("active"),m.classList.remove("active"),p(!0)})}),document.addEventListener("click",function(n){if(!m||!m.classList.contains("active"))return;const c=h.contains(n.target),u=n.target.closest(".popup-button"),v=n.target.closest(".popup-form__button");!c&&!u&&!v&&(m.classList.remove("active"),h.classList.remove("active"),p(!0))}),document.addEventListener("keydown",function(n){n.key==="Escape"&&m&&m.classList.contains("active")&&(m.classList.remove("active"),h.classList.remove("active"),p(!0))}),D(),O()});
